# Megre Guard DB Transfer

Приложение на Flask для переноса данных между базами данных Firebird (Dialect 1). Предназначено для выборочного копирования записей из таблицы `EVENTS` с проверкой на дубликаты.

## Возможности

*   **Выбор баз данных:** Интерактивный выбор путей к файлам баз данных источника и приемника (FDB).
*   **Фильтрация:** Настройка SQL-условия `WHERE` для выборки записей из источника.
*   **Контроль дубликатов:** Проверка существования записи в приемнике по заданным уникальным полям перед вставкой.
*   **Индикатор прогресса:** Визуальное отображение процесса переноса с логом операций в реальном времени.
*   **Сохранение настроек:** Автоматическое сохранение последних использованных путей и параметров в `config.json`.
*   **Поддержка Legacy:** Работает с Firebird Dialect 1 через драйвер `fdb`.

## Требования

*   Python 3.8+
*   Firebird Client Library (fbclient.dll / libfbclient.so) установленная в системе.

## Установка

1.  Клонируйте репозиторий:
    ```bash
    git clone https://github.com/majormguarde-bit/megre_guard_db.git
    cd megre_guard_db
    ```

2.  Создайте и активируйте виртуальное окружение:
    ```bash
    python -m venv venv
    # Windows
    venv\Scripts\activate
    # Linux/Mac
    source venv/bin/activate
    ```

3.  Установите зависимости:
    ```bash
    pip install -r requirements.txt
    ```

## Использование

1.  Запустите приложение:
    ```bash
    python app.py
    ```

2.  Откройте браузер и перейдите по адресу `http://localhost:5000`.

3.  Настройте параметры переноса:
    *   **Source/Dest Host & Port:** Адрес сервера Firebird (по умолчанию `localhost`, `3050`).
    *   **DB Path:** Путь к файлу базы данных (используйте кнопку "Browse...").
    *   **Table Name:** Имя таблицы для переноса (по умолчанию `EVENTS`).
    *   **Selection Condition:** SQL условие для выборки (например, `EVENTSDATE >= '01.01.2026'`).
    *   **Unique Columns:** Поля для проверки дубликатов (например, `READERID, EVENTSCODE, EVENTSDATE, CARDNUM`).

4.  Нажмите **Start Transfer**.

## Конфигурация

Настройки подключения (хост, порт, пути) и параметры переноса автоматически сохраняются в файл `config.json` в корневой директории приложения после каждого успешного запуска.

## Примечания

*   По умолчанию используются учетные данные `SYSDBA` / `masterkey`.
*   Поле `EVENTSID` (первичный ключ) исключено из переноса, предполагается, что целевая база сгенерирует новый ID (или использует триггер).
*   Приложение форсирует использование верхнего регистра для имен колонок при работе с данными для совместимости с Dialect 1.

## Лицензия

MIT
